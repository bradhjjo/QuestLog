# 🚀 Supabase 초보자 설정 가이드

이 가이드는 **QuestLog** 앱의 데이터 연동을 위해 Supabase(데이터베이스)를 설정하는 방법을 단계별로 설명합니다.

## 1단계: Supabase 가입 및 프로젝트 생성
1. [Supabase 홈페이지](https://supabase.com/)에 접속하여 **"Start your project"** 버튼을 클릭합니다.
2. GitHub 아이디로 로그인합니다 (없다면 가입이 필요합니다).
3. **"New Project"** 버튼을 클릭합니다.
4. 다음 정보를 입력하고 **"Create new project"**를 클릭합니다.
   - **Name**: `QuestLog` (원하는 이름)
   - **Database Password**: 강력한 비밀번호를 입력하고 **꼭 기억해두세요!**
   - **Region**: `Korea (Seoul)` 또는 가까운 지역 선택
5. 프로젝트가 생성될 때까지 잠시 기다립니다 (약 1~2분 소요).

## 2단계: 데이터베이스 테이블 만들기 (SQL 실행)
1. 왼쪽 메뉴바에서 **SQL Editor** 아이콘(📝 문서 모양)을 클릭합니다.
2. **"New query"** 버튼을 클릭합니다.
3. 아래의 SQL 코드를 복사하여 에디터에 붙여넣습니다. (프로젝트 폴더의 `supabase_schema.sql` 파일 내용과 같습니다)

```sql
-- 사용자 프로필 테이블 생성
create table profiles (
  id uuid references auth.users not null primary key,
  updated_at timestamp with time zone,
  username text unique,
  role text check (role in ('parent', 'teen')),
  xp integer default 0,
  constraint username_length check (char_length(username) >= 3)
);

-- 보안 설정 (RLS)
alter table profiles enable row level security;
create policy "Public profiles are viewable by everyone." on profiles for select using ( true );
create policy "Users can insert their own profile." on profiles for insert with check ( auth.uid() = id );
create policy "Users can update own profile." on profiles for update using ( auth.uid() = id );

-- 할 일(Todos) 테이블 생성
create table todos (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users not null,
  title text not null,
  reward integer default 10,
  status text check (status in ('pending', 'completed', 'approved')) default 'pending',
  inserted_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 보안 설정 (RLS)
alter table todos enable row level security;
create policy "Todos are viewable by everyone." on todos for select using ( true );
create policy "Users can insert their own todos." on todos for insert with check ( auth.uid() = user_id );
create policy "Users can update their own todos." on todos for update using ( auth.uid() = user_id );
```

4. 우측 하단의 **"Run"** 버튼을 클릭하여 실행합니다. "Success" 메시지가 뜨면 성공입니다!

## 3단계: API 키 가져오기
1. 왼쪽 메뉴바 맨 아래의 **Project Settings** 아이콘(⚙️ 톱니바퀴 모양)을 클릭합니다.
2. 메뉴에서 **"API"**를 선택합니다.
3. 다음 두 가지 값을 찾습니다 (복사 버튼을 사용하세요):
   - **Project URL**
   - **Project API keys** 섹션의 `anon` `public` 키

## 4단계: 프로젝트에 키 연결하기
1. 내 컴퓨터의 프로젝트 폴더(`c:\appdev\project001`)로 돌아옵니다.
2. `.env.example` 파일을 복사하여 `.env` 라는 이름으로 새 파일을 만듭니다.
3. `.env` 파일을 열고 복사한 값을 붙여넣습니다.

```env
VITE_SUPABASE_URL=여기에_Project_URL_붙여넣기
VITE_SUPABASE_ANON_KEY=여기에_anon_public_키_붙여넣기
```

## 5단계: 앱 실행하기
1. 터미널에서 개발 서버를 재시작합니다. (이미 켜져 있다면 `Ctrl + C`로 끄고 다시 실행)
   ```bash
   npm run dev
   ```
2. 브라우저에서 앱을 열고 회원가입을 진행해 보세요!
   - 부모 계정과 자녀 계정을 각각 만들어서 테스트해보세요.
   - 다른 브라우저나 시크릿 모드를 켜서 두 계정으로 동시에 로그인하면 실시간 연동을 확인할 수 있습니다.

---
**팁**: 이메일 인증 없이 바로 로그인되게 하려면 Supabase 대시보드 -> Authentication -> Providers -> Email -> "Confirm email"을 끄면 됩니다. (개발용으로 편리함)
